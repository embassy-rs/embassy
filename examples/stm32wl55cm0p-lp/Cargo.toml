[package]
edition = "2024"
name = "embassy-stm32wl55cm0-lp-examples"
version = "0.1.0"
license = "MIT OR Apache-2.0"
publish = false

[dependencies]
# Change stm32wl55jc-cm0 to your chip name, if necessary.
embassy-stm32 = { version = "0.5.0", path = "../../embassy-stm32", features = [
  "stm32wl55jc-cm0p",
  "time-driver-lptim1",
  "exti",
  "unstable-pac",
  "chrono",
  "low-power-pender",
] }
embassy-sync = { version = "0.7.2", path = "../../embassy-sync", features = [] }
# embassy-embedded-hal = { version = "0.5.0", path = "../../embassy-embedded-hal" }
embassy-executor = { version = "0.9.0", path = "../../embassy-executor", features = [] }
embassy-time = { version = "0.5.0", path = "../../embassy-time", features = [
  "tick-hz-1_000",
] }
embassy-futures = { version = "0.1.2", path = "../../embassy-futures" }

defmt = {version = "1.0.1", optional = true }
defmt-rtt = { version = "1.0.0", optional = true }
defmt-serial = { git = "https://github.com/gauteh/defmt-serial", rev = "411ae7fa909b4fd2667885aff687e009b9108190", optional = true }

cortex-m = { version = "0.7.6", features = [
  "inline-asm",
  "critical-section-single-core",
] }
cortex-m-rt = "0.7.0"
panic-probe = { version = "1.0.0", features = [] }
portable-atomic = { version = "1.13", features = ["unsafe-assume-single-core"] }
static_cell = "2"

[features]
default = ["defmt-serial"]
defmt = [
  "dep:defmt",
  "embassy-stm32/defmt",
  "embassy-sync/defmt",
  "embassy-executor/defmt",
  "embassy-time/defmt",
  "embassy-time/defmt-timestamp-uptime",
  "embassy-futures/defmt",
  "panic-probe/print-defmt",
]
defmt-serial = ["dep:defmt-serial", "defmt"]
defmt-rtt = ["dep:defmt-rtt", "defmt"]

[profile.dev]
codegen-units = 1
debug = 2
debug-assertions = true # <-
incremental = false
opt-level = "s" # <-
overflow-checks = true # <-

# cargo test
[profile.test]
codegen-units = 1
debug = 2
debug-assertions = true # <-
incremental = false
opt-level = 3           # <-
overflow-checks = true  # <-

# cargo build/run --release
[profile.release]
codegen-units = 16
debug = 2
debug-assertions = false # <-
incremental = false
opt-level = 3            # <-
overflow-checks = false  # <-

# cargo test --release
[profile.bench]
codegen-units = 1
debug = 2
debug-assertions = false # <-
incremental = false
lto = 'fat'
opt-level = 3            # <-
overflow-checks = false  # <-

[package.metadata.embassy]
build = [
  { target = "thumbv6m-none-eabi", artifact-dir = "out/examples/stm32wl55cm0p-lp" },
]
